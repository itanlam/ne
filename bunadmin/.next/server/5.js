exports.ids = [5];
exports.modules = {

/***/ "./plugins/buncms-user/sign-in/controllers/submitController.tsx":
/*!**********************************************************************!*\
  !*** ./plugins/buncms-user/sign-in/controllers/submitController.tsx ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _services_signInService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../services/signInService */ \"./plugins/buncms-user/sign-in/services/signInService.tsx\");\n/* harmony import */ var _utils_database_rxConnect__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/database/rxConnect */ \"./src/utils/database/rxConnect.tsx\");\n/* harmony import */ var _core_setting_collections__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/core/setting/collections */ \"./src/core/setting/collections.tsx\");\n/* harmony import */ var _core_auth_collections__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/core/auth/collections */ \"./src/core/auth/collections.tsx\");\n/* harmony import */ var _core_auth_schema__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/core/auth/schema */ \"./src/core/auth/schema.tsx\");\n/* harmony import */ var _utils_routes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/utils/routes */ \"./src/utils/routes/index.tsx\");\n/* harmony import */ var _core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/core */ \"./src/core/index.tsx\");\n\n\n\n\n\n\n\n\nconst submitController = async ({\n  t,\n  values,\n  setSubmitting,\n  router\n}) => {\n  const res = await Object(_services_signInService__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(values);\n  setSubmitting(false); // Sign-in successfully\n\n  if (res && res.token) {\n    // store user profile\n    const primary = _core_auth_schema__WEBPACK_IMPORTED_MODULE_4__[\"Primary\"];\n    const updated_at = Date.now();\n    const db = await Object(_utils_database_rxConnect__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(); // store auth\n\n    await db[_core_auth_collections__WEBPACK_IMPORTED_MODULE_3__[\"Collection\"].name].upsert({\n      [primary]: res.username,\n      token: res.token,\n      role: res.role,\n      details: JSON.stringify(res),\n      updated_at\n    }); // update username in setting\n\n    await db[_core_setting_collections__WEBPACK_IMPORTED_MODULE_2__[\"Collection\"].name].upsert({\n      name: _core_auth_schema__WEBPACK_IMPORTED_MODULE_4__[\"Primary\"],\n      value: res[_core_auth_schema__WEBPACK_IMPORTED_MODULE_4__[\"Primary\"]],\n      updated_at: Date.now()\n    }); // show notice\n\n    await Object(_core__WEBPACK_IMPORTED_MODULE_6__[\"notice\"])({\n      title: t(\"Sign in successful\")\n    }); // push to origin url\n\n    const {\n      asPath\n    } = router;\n    const pathArr = asPath.split(\"?redirect=\");\n    const redirect = pathArr[1] || \"/\";\n    const regex = /\\//g;\n    const matchStr = redirect.match(regex) || []; // is match /[group]/[name]\n\n    const isMatch = matchStr.length === 2;\n\n    if (regex && isMatch) {\n      router.replace(_utils_routes__WEBPACK_IMPORTED_MODULE_5__[\"DynamicRoute\"], redirect).then(_r => {});\n    } else {\n      router.replace(redirect).then(_r => {});\n    }\n  } else {\n    // show notice\n    await Object(_core__WEBPACK_IMPORTED_MODULE_6__[\"notice\"])({\n      title: t(\"Sign in failed\"),\n      severity: \"error\",\n      content: JSON.stringify(res)\n    });\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (submitController);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wbHVnaW5zL2J1bmNtcy11c2VyL3NpZ24taW4vY29udHJvbGxlcnMvc3VibWl0Q29udHJvbGxlci50c3g/YmEyYiJdLCJuYW1lcyI6WyJzdWJtaXRDb250cm9sbGVyIiwidCIsInZhbHVlcyIsInNldFN1Ym1pdHRpbmciLCJyb3V0ZXIiLCJyZXMiLCJ1c2VyU2lnbkluU2VydmljZSIsInRva2VuIiwicHJpbWFyeSIsIlByaW1hcnkiLCJ1cGRhdGVkX2F0IiwiRGF0ZSIsIm5vdyIsImRiIiwicnhEYiIsIkF1dGgiLCJuYW1lIiwidXBzZXJ0IiwidXNlcm5hbWUiLCJyb2xlIiwiZGV0YWlscyIsIkpTT04iLCJzdHJpbmdpZnkiLCJTZXR0aW5nIiwidmFsdWUiLCJub3RpY2UiLCJ0aXRsZSIsImFzUGF0aCIsInBhdGhBcnIiLCJzcGxpdCIsInJlZGlyZWN0IiwicmVnZXgiLCJtYXRjaFN0ciIsIm1hdGNoIiwiaXNNYXRjaCIsImxlbmd0aCIsInJlcGxhY2UiLCJEeW5hbWljUm91dGUiLCJ0aGVuIiwiX3IiLCJzZXZlcml0eSIsImNvbnRlbnQiXSwibWFwcGluZ3MiOiJBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFVQSxNQUFNQSxnQkFBZ0IsR0FBRyxPQUFPO0FBQzlCQyxHQUQ4QjtBQUU5QkMsUUFGOEI7QUFHOUJDLGVBSDhCO0FBSTlCQztBQUo4QixDQUFQLEtBS1o7QUFDWCxRQUFNQyxHQUFHLEdBQUcsTUFBTUMsdUVBQWlCLENBQUNKLE1BQUQsQ0FBbkM7QUFDQUMsZUFBYSxDQUFDLEtBQUQsQ0FBYixDQUZXLENBR1g7O0FBQ0EsTUFBSUUsR0FBRyxJQUFJQSxHQUFHLENBQUNFLEtBQWYsRUFBc0I7QUFDcEI7QUFDQSxVQUFNQyxPQUFPLEdBQUdDLHlEQUFoQjtBQUNBLFVBQU1DLFVBQVUsR0FBR0MsSUFBSSxDQUFDQyxHQUFMLEVBQW5CO0FBRUEsVUFBTUMsRUFBRSxHQUFHLE1BQU1DLHlFQUFJLEVBQXJCLENBTG9CLENBTXBCOztBQUNBLFVBQU1ELEVBQUUsQ0FBQ0UsaUVBQUksQ0FBQ0MsSUFBTixDQUFGLENBQWNDLE1BQWQsQ0FBcUI7QUFDekIsT0FBQ1QsT0FBRCxHQUFXSCxHQUFHLENBQUNhLFFBRFU7QUFFekJYLFdBQUssRUFBRUYsR0FBRyxDQUFDRSxLQUZjO0FBR3pCWSxVQUFJLEVBQUVkLEdBQUcsQ0FBQ2MsSUFIZTtBQUl6QkMsYUFBTyxFQUFFQyxJQUFJLENBQUNDLFNBQUwsQ0FBZWpCLEdBQWYsQ0FKZ0I7QUFLekJLO0FBTHlCLEtBQXJCLENBQU4sQ0FQb0IsQ0FjcEI7O0FBQ0EsVUFBTUcsRUFBRSxDQUFDVSxvRUFBTyxDQUFDUCxJQUFULENBQUYsQ0FBaUJDLE1BQWpCLENBQXdCO0FBQzVCRCxVQUFJLEVBQUVQLHlEQURzQjtBQUU1QmUsV0FBSyxFQUFFbkIsR0FBRyxDQUFDSSx5REFBRCxDQUZrQjtBQUc1QkMsZ0JBQVUsRUFBRUMsSUFBSSxDQUFDQyxHQUFMO0FBSGdCLEtBQXhCLENBQU4sQ0Fmb0IsQ0FvQnBCOztBQUNBLFVBQU1hLG9EQUFNLENBQUM7QUFBRUMsV0FBSyxFQUFFekIsQ0FBQyxDQUFDLG9CQUFEO0FBQVYsS0FBRCxDQUFaLENBckJvQixDQXNCcEI7O0FBQ0EsVUFBTTtBQUFFMEI7QUFBRixRQUFhdkIsTUFBbkI7QUFDQSxVQUFNd0IsT0FBTyxHQUFHRCxNQUFNLENBQUNFLEtBQVAsQ0FBYSxZQUFiLENBQWhCO0FBQ0EsVUFBTUMsUUFBUSxHQUFHRixPQUFPLENBQUMsQ0FBRCxDQUFQLElBQWMsR0FBL0I7QUFDQSxVQUFNRyxLQUFLLEdBQUcsS0FBZDtBQUNBLFVBQU1DLFFBQTBCLEdBQUdGLFFBQVEsQ0FBQ0csS0FBVCxDQUFlRixLQUFmLEtBQXlCLEVBQTVELENBM0JvQixDQTRCcEI7O0FBQ0EsVUFBTUcsT0FBTyxHQUFHRixRQUFRLENBQUNHLE1BQVQsS0FBb0IsQ0FBcEM7O0FBRUEsUUFBSUosS0FBSyxJQUFJRyxPQUFiLEVBQXNCO0FBQ3BCOUIsWUFBTSxDQUFDZ0MsT0FBUCxDQUFlQywwREFBZixFQUE2QlAsUUFBN0IsRUFBdUNRLElBQXZDLENBQTRDQyxFQUFFLElBQUksQ0FBRSxDQUFwRDtBQUNELEtBRkQsTUFFTztBQUNMbkMsWUFBTSxDQUFDZ0MsT0FBUCxDQUFlTixRQUFmLEVBQXlCUSxJQUF6QixDQUE4QkMsRUFBRSxJQUFJLENBQUUsQ0FBdEM7QUFDRDtBQUNGLEdBcENELE1Bb0NPO0FBQ0w7QUFDQSxVQUFNZCxvREFBTSxDQUFDO0FBQ1hDLFdBQUssRUFBRXpCLENBQUMsQ0FBQyxnQkFBRCxDQURHO0FBRVh1QyxjQUFRLEVBQUUsT0FGQztBQUdYQyxhQUFPLEVBQUVwQixJQUFJLENBQUNDLFNBQUwsQ0FBZWpCLEdBQWY7QUFIRSxLQUFELENBQVo7QUFLRDtBQUNGLENBckREOztBQXVEZUwsK0VBQWYiLCJmaWxlIjoiLi9wbHVnaW5zL2J1bmNtcy11c2VyL3NpZ24taW4vY29udHJvbGxlcnMvc3VibWl0Q29udHJvbGxlci50c3guanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWYWx1ZXMgfSBmcm9tIFwiLi4vdHlwZXNcIlxuaW1wb3J0IHVzZXJTaWduSW5TZXJ2aWNlIGZyb20gXCIuLi9zZXJ2aWNlcy9zaWduSW5TZXJ2aWNlXCJcblxuaW1wb3J0IHJ4RGIgZnJvbSBcIkAvdXRpbHMvZGF0YWJhc2UvcnhDb25uZWN0XCJcbmltcG9ydCB7IENvbGxlY3Rpb24gYXMgU2V0dGluZyB9IGZyb20gXCJAL2NvcmUvc2V0dGluZy9jb2xsZWN0aW9uc1wiXG5pbXBvcnQgeyBDb2xsZWN0aW9uIGFzIEF1dGggfSBmcm9tIFwiQC9jb3JlL2F1dGgvY29sbGVjdGlvbnNcIlxuaW1wb3J0IHsgUHJpbWFyeSB9IGZyb20gXCJAL2NvcmUvYXV0aC9zY2hlbWFcIlxuaW1wb3J0IHsgRHluYW1pY1JvdXRlIH0gZnJvbSBcIkAvdXRpbHMvcm91dGVzXCJcbmltcG9ydCB7IE5leHRSb3V0ZXIgfSBmcm9tIFwibmV4dC9yb3V0ZXJcIlxuaW1wb3J0IHsgbm90aWNlIH0gZnJvbSBcIkAvY29yZVwiXG5pbXBvcnQgeyBURnVuY3Rpb24gfSBmcm9tIFwiaTE4bmV4dFwiXG5cbmludGVyZmFjZSBQcm9wcyB7XG4gIHQ6IFRGdW5jdGlvblxuICB2YWx1ZXM6IFZhbHVlc1xuICBzZXRTdWJtaXR0aW5nOiAoaXNTdWJtaXR0aW5nOiBib29sZWFuKSA9PiB2b2lkXG4gIHJvdXRlcjogTmV4dFJvdXRlclxufVxuXG5jb25zdCBzdWJtaXRDb250cm9sbGVyID0gYXN5bmMgKHtcbiAgdCxcbiAgdmFsdWVzLFxuICBzZXRTdWJtaXR0aW5nLFxuICByb3V0ZXJcbn06IFByb3BzKSA9PiB7XG4gIGNvbnN0IHJlcyA9IGF3YWl0IHVzZXJTaWduSW5TZXJ2aWNlKHZhbHVlcylcbiAgc2V0U3VibWl0dGluZyhmYWxzZSlcbiAgLy8gU2lnbi1pbiBzdWNjZXNzZnVsbHlcbiAgaWYgKHJlcyAmJiByZXMudG9rZW4pIHtcbiAgICAvLyBzdG9yZSB1c2VyIHByb2ZpbGVcbiAgICBjb25zdCBwcmltYXJ5ID0gUHJpbWFyeVxuICAgIGNvbnN0IHVwZGF0ZWRfYXQgPSBEYXRlLm5vdygpXG5cbiAgICBjb25zdCBkYiA9IGF3YWl0IHJ4RGIoKVxuICAgIC8vIHN0b3JlIGF1dGhcbiAgICBhd2FpdCBkYltBdXRoLm5hbWVdLnVwc2VydCh7XG4gICAgICBbcHJpbWFyeV06IHJlcy51c2VybmFtZSxcbiAgICAgIHRva2VuOiByZXMudG9rZW4sXG4gICAgICByb2xlOiByZXMucm9sZSxcbiAgICAgIGRldGFpbHM6IEpTT04uc3RyaW5naWZ5KHJlcyksXG4gICAgICB1cGRhdGVkX2F0XG4gICAgfSlcbiAgICAvLyB1cGRhdGUgdXNlcm5hbWUgaW4gc2V0dGluZ1xuICAgIGF3YWl0IGRiW1NldHRpbmcubmFtZV0udXBzZXJ0KHtcbiAgICAgIG5hbWU6IFByaW1hcnksXG4gICAgICB2YWx1ZTogcmVzW1ByaW1hcnldLFxuICAgICAgdXBkYXRlZF9hdDogRGF0ZS5ub3coKVxuICAgIH0pXG4gICAgLy8gc2hvdyBub3RpY2VcbiAgICBhd2FpdCBub3RpY2UoeyB0aXRsZTogdChcIlNpZ24gaW4gc3VjY2Vzc2Z1bFwiKSB9KVxuICAgIC8vIHB1c2ggdG8gb3JpZ2luIHVybFxuICAgIGNvbnN0IHsgYXNQYXRoIH0gPSByb3V0ZXJcbiAgICBjb25zdCBwYXRoQXJyID0gYXNQYXRoLnNwbGl0KFwiP3JlZGlyZWN0PVwiKVxuICAgIGNvbnN0IHJlZGlyZWN0ID0gcGF0aEFyclsxXSB8fCBcIi9cIlxuICAgIGNvbnN0IHJlZ2V4ID0gL1xcLy9nXG4gICAgY29uc3QgbWF0Y2hTdHI6IFJlZ0V4cE1hdGNoQXJyYXkgPSByZWRpcmVjdC5tYXRjaChyZWdleCkgfHwgW11cbiAgICAvLyBpcyBtYXRjaCAvW2dyb3VwXS9bbmFtZV1cbiAgICBjb25zdCBpc01hdGNoID0gbWF0Y2hTdHIubGVuZ3RoID09PSAyXG5cbiAgICBpZiAocmVnZXggJiYgaXNNYXRjaCkge1xuICAgICAgcm91dGVyLnJlcGxhY2UoRHluYW1pY1JvdXRlLCByZWRpcmVjdCkudGhlbihfciA9PiB7fSlcbiAgICB9IGVsc2Uge1xuICAgICAgcm91dGVyLnJlcGxhY2UocmVkaXJlY3QpLnRoZW4oX3IgPT4ge30pXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIHNob3cgbm90aWNlXG4gICAgYXdhaXQgbm90aWNlKHtcbiAgICAgIHRpdGxlOiB0KFwiU2lnbiBpbiBmYWlsZWRcIiksXG4gICAgICBzZXZlcml0eTogXCJlcnJvclwiLFxuICAgICAgY29udGVudDogSlNPTi5zdHJpbmdpZnkocmVzKVxuICAgIH0pXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgc3VibWl0Q29udHJvbGxlclxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./plugins/buncms-user/sign-in/controllers/submitController.tsx\n");

/***/ }),

/***/ "./plugins/buncms-user/sign-in/services/signInService.tsx":
/*!****************************************************************!*\
  !*** ./plugins/buncms-user/sign-in/services/signInService.tsx ***!
  \****************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _utils_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/utils/config */ \"./src/utils/config/index.tsx\");\n/* harmony import */ var _utils_scripts_request__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/utils/scripts/request */ \"./src/utils/scripts/request.tsx\");\n\n\n\nasync function userSignInService(params) {\n  return Object(_utils_scripts_request__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(\"/auth/login\", {\n    prefix: _utils_config__WEBPACK_IMPORTED_MODULE_0__[\"ENV\"].AUTH_URL,\n    method: \"POST\",\n    data: params\n  });\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (userSignInService);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9wbHVnaW5zL2J1bmNtcy11c2VyL3NpZ24taW4vc2VydmljZXMvc2lnbkluU2VydmljZS50c3g/ZDBkYSJdLCJuYW1lcyI6WyJ1c2VyU2lnbkluU2VydmljZSIsInBhcmFtcyIsInJlcXVlc3QiLCJwcmVmaXgiLCJFTlYiLCJBVVRIX1VSTCIsIm1ldGhvZCIsImRhdGEiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBT0EsZUFBZUEsaUJBQWYsQ0FBaUNDLE1BQWpDLEVBQTJEO0FBQ3pELFNBQU9DLHNFQUFPLENBQUMsYUFBRCxFQUFnQjtBQUM1QkMsVUFBTSxFQUFFQyxpREFBRyxDQUFDQyxRQURnQjtBQUU1QkMsVUFBTSxFQUFFLE1BRm9CO0FBRzVCQyxRQUFJLEVBQUVOO0FBSHNCLEdBQWhCLENBQWQ7QUFLRDs7QUFFY0QsZ0ZBQWYiLCJmaWxlIjoiLi9wbHVnaW5zL2J1bmNtcy11c2VyL3NpZ24taW4vc2VydmljZXMvc2lnbkluU2VydmljZS50c3guanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBFTlYgfSBmcm9tIFwiQC91dGlscy9jb25maWdcIlxuaW1wb3J0IHJlcXVlc3QgZnJvbSBcIkAvdXRpbHMvc2NyaXB0cy9yZXF1ZXN0XCJcblxuZXhwb3J0IGludGVyZmFjZSBTaWduSW5QYXJhbXNUeXBlIHtcbiAgdXNlcm5hbWU6IHN0cmluZ1xuICBwYXNzd29yZDogc3RyaW5nXG59XG5cbmFzeW5jIGZ1bmN0aW9uIHVzZXJTaWduSW5TZXJ2aWNlKHBhcmFtczogU2lnbkluUGFyYW1zVHlwZSkge1xuICByZXR1cm4gcmVxdWVzdChcIi9hdXRoL2xvZ2luXCIsIHtcbiAgICBwcmVmaXg6IEVOVi5BVVRIX1VSTCxcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGRhdGE6IHBhcmFtc1xuICB9KVxufVxuXG5leHBvcnQgZGVmYXVsdCB1c2VyU2lnbkluU2VydmljZVxuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./plugins/buncms-user/sign-in/services/signInService.tsx\n");

/***/ })

};;