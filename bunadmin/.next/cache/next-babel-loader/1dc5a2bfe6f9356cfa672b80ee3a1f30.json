{"ast":null,"code":"var _jsxFileName = \"/Volumes/Untitled/GitHub/itanlam/ne/bunadmin/src/core/schema/index.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState } from \"react\";\nimport { useTheme } from \"@material-ui/core/styles\";\nimport { CommonTableDefaultProps as DefaultProps } from \"@/components/CommonTable/models/defaultProps\";\nimport CommonTable, { CommonTableHead } from \"@/components/CommonTable\";\nimport tableIcons from \"@/components/CommonTable/models/tableIcons\";\nimport rxSubscribe from \"@/utils/database/rxSubscribe\";\nimport { Columns } from \"./columns\";\nimport { Schema } from \"./schema\";\nimport { editableController } from \"./controllers/editableController\";\nimport { Collection } from \"./collections\";\nimport ConfirmDialog from \"@/components/CommonDialog/ConfirmDialog\";\nimport rxDb from \"@/utils/database/rxConnect\";\nimport dynamic from \"next/dynamic\";\nimport jsonViewStyles from \"@/utils/styles/jsonViewStyles\";\nimport { useTranslation } from \"react-i18next\";\nconst DynamicReactJson = dynamic(() => import(\"react-json-view\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"react-json-view\")],\n    modules: [\"react-json-view\"]\n  }\n});\nexport default function SchemaManagerContainer() {\n  const {\n    t\n  } = useTranslation(\"table\");\n  const theme = useTheme();\n  const {\n    0: data,\n    1: setData\n  } = useState([]);\n  const {\n    0: selData,\n    1: setSelData\n  } = useState();\n  const {\n    0: modalState,\n    1: setModalState\n  } = useState({\n    open: 0,\n    title: \"\",\n    msg: \"\"\n  });\n  React.useEffect(() => {\n    ;\n\n    (async () => {\n      await rxSubscribe({\n        collection: Collection.name,\n        sort: {\n          id: \"asc\"\n        },\n        callback: data => setData(data)\n      });\n    })();\n  }, []);\n  return __jsx(React.Fragment, null, __jsx(React.Fragment, null, __jsx(CommonTableHead, {\n    title: t(Schema.title),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 9\n    }\n  }), __jsx(CommonTable, {\n    title: t(Schema.title),\n    columns: Columns({\n      t\n    }),\n    editable: editableController(),\n    data: data // style\n    ,\n    style: DefaultProps.style // icons\n    ,\n    icons: tableIcons({\n      theme\n    }) // options\n    ,\n    options: _objectSpread(_objectSpread({}, DefaultProps.options), {}, {\n      filtering: true,\n      grouping: true\n    }) // actions\n    ,\n    actions: [{\n      tooltip: \"Remove All Selected Schemas\",\n      icon: \"delete\",\n      onClick: (_evt, data) => {\n        data = data;\n        const msg = \"Do you want to delete \" + data.length + \" rows ?\";\n        setModalState({\n          title: \"Bulk delete\",\n          open: modalState.open + 1,\n          msg\n        });\n        setSelData(data);\n      }\n    }] // detailPanel\n    ,\n    detailPanel: [{\n      icon: \"code\",\n      render: rowData => {\n        if (!rowData.columns) {\n          return __jsx(\"div\", {\n            style: {\n              color: \"white\",\n              backgroundColor: theme.bunadmin.iconColor,\n              padding: \"10px 30px\"\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 81,\n              columnNumber: 21\n            }\n          }, rowData.columns || \"COLUMNS IS EMPTY\");\n        } else {\n          const arr = JSON.parse(rowData.columns) || [];\n          return __jsx(DynamicReactJson, {\n            src: arr,\n            theme: \"summerfruit:inverted\",\n            iconStyle: \"circle\",\n            collapseStringsAfterLength: 20,\n            displayObjectSize: false,\n            displayDataTypes: false,\n            style: jsonViewStyles({\n              theme\n            }),\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 21\n            }\n          });\n        } // check columns\n\n      } // render\n\n    } // item\n    ],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  })), __jsx(ConfirmDialog, {\n    openModal: modalState.open,\n    title: modalState.title,\n    msg: modalState.msg,\n    doFunc: () => {\n      // bulk delete\n      if (selData && selData.length > 0) {\n        // @ts-ignore\n        selData.map(async item => {\n          try {\n            const db = await rxDb();\n            const query = db[Collection.name].findOne().where(\"id\").eq(item.id);\n            await query.remove();\n          } catch (e) {\n            console.error(e);\n          }\n        });\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }\n  }));\n}","map":{"version":3,"sources":["/Volumes/Untitled/GitHub/itanlam/ne/bunadmin/src/core/schema/index.tsx"],"names":["React","useState","useTheme","CommonTableDefaultProps","DefaultProps","CommonTable","CommonTableHead","tableIcons","rxSubscribe","Columns","Schema","editableController","Collection","ConfirmDialog","rxDb","dynamic","jsonViewStyles","useTranslation","DynamicReactJson","ssr","SchemaManagerContainer","t","theme","data","setData","selData","setSelData","modalState","setModalState","open","title","msg","useEffect","collection","name","sort","id","callback","style","options","filtering","grouping","tooltip","icon","onClick","_evt","length","render","rowData","columns","color","backgroundColor","bunadmin","iconColor","padding","arr","JSON","parse","map","item","db","query","findOne","where","eq","remove","e","console","error"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AAEA,SAASC,QAAT,QAAyB,0BAAzB;AACA,SAASC,uBAAuB,IAAIC,YAApC,QAAwD,8CAAxD;AAEA,OAAOC,WAAP,IAAsBC,eAAtB,QAA6C,0BAA7C;AACA,OAAOC,UAAP,MAAuB,4CAAvB;AACA,OAAOC,WAAP,MAAwB,8BAAxB;AACA,SAASC,OAAT,QAAwB,WAAxB;AACA,SAASC,MAAT,QAAuB,UAAvB;AACA,SAASC,kBAAT,QAAmC,kCAAnC;AACA,SAASC,UAAT,QAA2B,eAA3B;AACA,OAAOC,aAAP,MAA0B,yCAA1B;AACA,OAAOC,IAAP,MAAiB,4BAAjB;AACA,OAAOC,OAAP,MAAoB,cAApB;AACA,OAAOC,cAAP,MAA2B,+BAA3B;AAEA,SAASC,cAAT,QAA+B,eAA/B;AACA,MAAMC,gBAAgB,GAAGH,OAAO,OAAC,OAAO,iBAAP,CAAD,EAA4B;AAAEI,EAAAA,GAAG,EAAE,KAAP;AAAA;AAAA,wCAApB,iBAAoB;AAAA,cAApB,iBAAoB;AAAA;AAAA,CAA5B,CAAhC;AAEA,eAAe,SAASC,sBAAT,GAAkC;AAC/C,QAAM;AAAEC,IAAAA;AAAF,MAAQJ,cAAc,CAAC,OAAD,CAA5B;AACA,QAAMK,KAAK,GAAGpB,QAAQ,EAAtB;AACA,QAAM;AAAA,OAACqB,IAAD;AAAA,OAAOC;AAAP,MAAkBvB,QAAQ,CAAC,EAAD,CAAhC;AACA,QAAM;AAAA,OAACwB,OAAD;AAAA,OAAUC;AAAV,MAAwBzB,QAAQ,EAAtC;AACA,QAAM;AAAA,OAAC0B,UAAD;AAAA,OAAaC;AAAb,MAA8B3B,QAAQ,CAAC;AAC3C4B,IAAAA,IAAI,EAAE,CADqC;AAE3CC,IAAAA,KAAK,EAAE,EAFoC;AAG3CC,IAAAA,GAAG,EAAE;AAHsC,GAAD,CAA5C;AAMA/B,EAAAA,KAAK,CAACgC,SAAN,CAAgB,MAAM;AACpB;;AAAC,KAAC,YAAY;AACZ,YAAMxB,WAAW,CAAC;AAChByB,QAAAA,UAAU,EAAErB,UAAU,CAACsB,IADP;AAEhBC,QAAAA,IAAI,EAAE;AAAEC,UAAAA,EAAE,EAAE;AAAN,SAFU;AAGhBC,QAAAA,QAAQ,EAAEd,IAAI,IAAIC,OAAO,CAACD,IAAD;AAHT,OAAD,CAAjB;AAKD,KANA;AAOF,GARD,EAQG,EARH;AAUA,SACE,4BACE,4BACE,MAAC,eAAD;AAAiB,IAAA,KAAK,EAAEF,CAAC,CAACX,MAAM,CAACoB,KAAR,CAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE,MAAC,WAAD;AACE,IAAA,KAAK,EAAET,CAAC,CAACX,MAAM,CAACoB,KAAR,CADV;AAEE,IAAA,OAAO,EAAErB,OAAO,CAAC;AAAEY,MAAAA;AAAF,KAAD,CAFlB;AAGE,IAAA,QAAQ,EAAEV,kBAAkB,EAH9B;AAIE,IAAA,IAAI,EAAEY,IAJR,CAKE;AALF;AAME,IAAA,KAAK,EAAEnB,YAAY,CAACkC,KANtB,CAOE;AAPF;AAQE,IAAA,KAAK,EAAE/B,UAAU,CAAC;AAAEe,MAAAA;AAAF,KAAD,CARnB,CASE;AATF;AAUE,IAAA,OAAO,kCAAOlB,YAAY,CAACmC,OAApB;AAA6BC,MAAAA,SAAS,EAAE,IAAxC;AAA8CC,MAAAA,QAAQ,EAAE;AAAxD,MAVT,CAWE;AAXF;AAYE,IAAA,OAAO,EAAE,CACP;AACEC,MAAAA,OAAO,EAAE,6BADX;AAEEC,MAAAA,IAAI,EAAE,QAFR;AAGEC,MAAAA,OAAO,EAAE,CAACC,IAAD,EAAOtB,IAAP,KAAgB;AACvBA,QAAAA,IAAI,GAAGA,IAAP;AACA,cAAMQ,GAAG,GAAG,2BAA2BR,IAAI,CAACuB,MAAhC,GAAyC,SAArD;AACAlB,QAAAA,aAAa,CAAC;AACZE,UAAAA,KAAK,EAAE,aADK;AAEZD,UAAAA,IAAI,EAAEF,UAAU,CAACE,IAAX,GAAkB,CAFZ;AAGZE,UAAAA;AAHY,SAAD,CAAb;AAKAL,QAAAA,UAAU,CAACH,IAAD,CAAV;AACD;AAZH,KADO,CAZX,CA4BE;AA5BF;AA6BE,IAAA,WAAW,EAAE,CACX;AACEoB,MAAAA,IAAI,EAAE,MADR;AAEEI,MAAAA,MAAM,EAAEC,OAAO,IAAI;AACjB,YAAI,CAACA,OAAO,CAACC,OAAb,EAAsB;AACpB,iBACE;AACE,YAAA,KAAK,EAAE;AACLC,cAAAA,KAAK,EAAE,OADF;AAELC,cAAAA,eAAe,EAAE7B,KAAK,CAAC8B,QAAN,CAAeC,SAF3B;AAGLC,cAAAA,OAAO,EAAE;AAHJ,aADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAOGN,OAAO,CAACC,OAAR,IAAmB,kBAPtB,CADF;AAWD,SAZD,MAYO;AACL,gBAAMM,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWT,OAAO,CAACC,OAAnB,KAA+B,EAA3C;AACA,iBACE,MAAC,gBAAD;AACE,YAAA,GAAG,EAAEM,GADP;AAEE,YAAA,KAAK,EAAC,sBAFR;AAGE,YAAA,SAAS,EAAC,QAHZ;AAIE,YAAA,0BAA0B,EAAE,EAJ9B;AAKE,YAAA,iBAAiB,EAAE,KALrB;AAME,YAAA,gBAAgB,EAAE,KANpB;AAOE,YAAA,KAAK,EAAEvC,cAAc,CAAC;AAAEM,cAAAA;AAAF,aAAD,CAPvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADF;AAWD,SA1BgB,CA0Bf;;AACH,OA7BH,CA6BI;;AA7BJ,KADW,CA+BT;AA/BS,KA7Bf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADF,EAoEE,MAAC,aAAD;AACE,IAAA,SAAS,EAAEK,UAAU,CAACE,IADxB;AAEE,IAAA,KAAK,EAAEF,UAAU,CAACG,KAFpB;AAGE,IAAA,GAAG,EAAEH,UAAU,CAACI,GAHlB;AAIE,IAAA,MAAM,EAAE,MAAM;AACZ;AACA,UAAIN,OAAO,IAAIA,OAAO,CAACqB,MAAR,GAAiB,CAAhC,EAAmC;AACjC;AACArB,QAAAA,OAAO,CAACiC,GAAR,CAAY,MAAMC,IAAN,IAAc;AACxB,cAAI;AACF,kBAAMC,EAAE,GAAG,MAAM9C,IAAI,EAArB;AAEA,kBAAM+C,KAAK,GAAGD,EAAE,CAAChD,UAAU,CAACsB,IAAZ,CAAF,CACX4B,OADW,GAEXC,KAFW,CAEL,IAFK,EAGXC,EAHW,CAGRL,IAAI,CAACvB,EAHG,CAAd;AAKA,kBAAMyB,KAAK,CAACI,MAAN,EAAN;AACD,WATD,CASE,OAAOC,CAAP,EAAU;AACVC,YAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACD;AACF,SAbD;AAcD;AACF,KAvBH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IApEF,CADF;AAgGD","sourcesContent":["import React, { useState } from \"react\"\n\nimport { useTheme } from \"@material-ui/core/styles\"\nimport { CommonTableDefaultProps as DefaultProps } from \"@/components/CommonTable/models/defaultProps\"\n\nimport CommonTable, { CommonTableHead } from \"@/components/CommonTable\"\nimport tableIcons from \"@/components/CommonTable/models/tableIcons\"\nimport rxSubscribe from \"@/utils/database/rxSubscribe\"\nimport { Columns } from \"./columns\"\nimport { Schema } from \"./schema\"\nimport { editableController } from \"./controllers/editableController\"\nimport { Collection } from \"./collections\"\nimport ConfirmDialog from \"@/components/CommonDialog/ConfirmDialog\"\nimport rxDb from \"@/utils/database/rxConnect\"\nimport dynamic from \"next/dynamic\"\nimport jsonViewStyles from \"@/utils/styles/jsonViewStyles\"\nimport { Type } from \"./types\"\nimport { useTranslation } from \"react-i18next\"\nconst DynamicReactJson = dynamic(import(\"react-json-view\"), { ssr: false })\n\nexport default function SchemaManagerContainer() {\n  const { t } = useTranslation(\"table\")\n  const theme = useTheme()\n  const [data, setData] = useState([])\n  const [selData, setSelData] = useState<Type[]>()\n  const [modalState, setModalState] = useState({\n    open: 0,\n    title: \"\",\n    msg: \"\"\n  })\n\n  React.useEffect(() => {\n    ;(async () => {\n      await rxSubscribe({\n        collection: Collection.name,\n        sort: { id: \"asc\" },\n        callback: data => setData(data)\n      })\n    })()\n  }, [])\n\n  return (\n    <>\n      <>\n        <CommonTableHead title={t(Schema.title)} />\n        <CommonTable\n          title={t(Schema.title)}\n          columns={Columns({ t })}\n          editable={editableController()}\n          data={data}\n          // style\n          style={DefaultProps.style}\n          // icons\n          icons={tableIcons({ theme })}\n          // options\n          options={{ ...DefaultProps.options, filtering: true, grouping: true }}\n          // actions\n          actions={[\n            {\n              tooltip: \"Remove All Selected Schemas\",\n              icon: \"delete\",\n              onClick: (_evt, data) => {\n                data = data as Type[]\n                const msg = \"Do you want to delete \" + data.length + \" rows ?\"\n                setModalState({\n                  title: \"Bulk delete\",\n                  open: modalState.open + 1,\n                  msg\n                })\n                setSelData(data)\n              }\n            }\n          ]}\n          // detailPanel\n          detailPanel={[\n            {\n              icon: \"code\",\n              render: rowData => {\n                if (!rowData.columns) {\n                  return (\n                    <div\n                      style={{\n                        color: \"white\",\n                        backgroundColor: theme.bunadmin.iconColor,\n                        padding: \"10px 30px\"\n                      }}\n                    >\n                      {rowData.columns || \"COLUMNS IS EMPTY\"}\n                    </div>\n                  )\n                } else {\n                  const arr = JSON.parse(rowData.columns) || []\n                  return (\n                    <DynamicReactJson\n                      src={arr}\n                      theme=\"summerfruit:inverted\"\n                      iconStyle=\"circle\"\n                      collapseStringsAfterLength={20}\n                      displayObjectSize={false}\n                      displayDataTypes={false}\n                      style={jsonViewStyles({ theme })}\n                    />\n                  )\n                } // check columns\n              } // render\n            } // item\n          ]}\n        />\n      </>\n      {/* ConfirmDialog */}\n      <ConfirmDialog\n        openModal={modalState.open}\n        title={modalState.title}\n        msg={modalState.msg}\n        doFunc={() => {\n          // bulk delete\n          if (selData && selData.length > 0) {\n            // @ts-ignore\n            selData.map(async item => {\n              try {\n                const db = await rxDb()\n\n                const query = db[Collection.name]\n                  .findOne()\n                  .where(\"id\")\n                  .eq(item.id)\n\n                await query.remove()\n              } catch (e) {\n                console.error(e)\n              }\n            })\n          }\n        }}\n      />\n    </>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}